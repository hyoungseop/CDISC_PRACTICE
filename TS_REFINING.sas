
*FDA STUDY DATA TECHNICAL CONFORMANCE GUIDE OCTOBER 2019 참조하여 파일 수정;

data TS00; 
retain STUDYID TSPARMCD TSPARM TSVAL TSVALNF TSVALCD TSVCDREF TSVCDVER;
format STUDYID $6. TSPARMCD $40. TSPARM $100. TSVAL $100. TSVALNF $40. TSVALCD $40. TSVCDREF $40. TSVCDVER $40.;
set PROTOCOL.PROTOCOL_TS_SAMPLE; 

call missing(TSVCDREF, TSVCDVER);

**TSPARMCD: 축약 코드값;
*1. TSPARMCD 정제;
if TSPARMCD = 'PHASE' then TSPARMCD = 'TPHASE'; *PHASE -> TPHASE;
if TSPARMCD = 'RANDOM' then delete; *RANDOM은 존재하지 않아서 삭제;

*2. TSVALNF,TSVALCD,TSVCDREF, TSVCDVER 변수 생성 및 값 추가;
*PHARMASUG 2016-PAPER DS11 참조;
**TSVALNF:TSVAL이 결측일 떄 왜 결측인지 구조화;
**TSVALCD:TSVAL 코드화;
**TSVALREF:TSVALCD 코드 용어집 이름;
**TSVALNF:TSVALREF 용어집 버전 또는 날짜;

if TSPARMCD in ('SSTDTC' 'SENDTC') then TSVCDREF = 'ISO 8601';
if TSPARMCD = 'TPHASE' then do; TSVALCD = 'C15601'; TSVCDREF = 'CDISC'; TSVCDVER = '2024-06-28'; end;
*1상:C15600, 2상:C15601, 3상:C15602, 4상:C15603; 
if TSPARMCD = 'TTYPE' then do; TSVALCD = 'C98388'; TSVCDREF = 'CDISC'; TSVCDVER = '2024-06-28'; end;

drop TSSEQ;
run;


*FDA 필수 파라미터 추가(17개);
data TS01;

infile datalines dlm = '|' missover;

input STUDYID:$6. TSPARMCD:$40. TSPARM:$100. TSVAL:$100. TSVALNF:$40. TSVALCD:$40. TSVCDREF:$40. TSVCDVER:$40.;

datalines;
ABC111 |ACTSUB |Actual Number of Subjects | |NAV | |ISO 21090 |
ABC111 |AGEMAX |Planned Maximum Age of Subjects | |PINF | |ISO 21090 |
ABC111 |STYPE |Study Type |INTERVENTIONAL | |C98388 |CDISC |2024-06-28
ABC111 |SEXPOP |Sex of Participants |BOTH | |C124294 |CDISC |2024-06-28
ABC111 |HLTSUBJI |Healthy Subject Indicator |N | |C49487 |CDISC |2024-06-28
ABC111 |TBLIND |Trial Blinding Schema |DOUBLE BLIND | |C15228 |CDISC |2024-06-28
ABC111 |TCNTRL |Control Type |PLACEBO | |C49635 |CDISC |2024-06-28
ABC111 |TRT |Investigational Therapy or Treatment |Study Drug ABC123 | |6CW7F3G59X |UNII |
ABC111 |LENGTH |Trial Length |P6M | | |ISO 8601 |
ABC111 |STOPRULE |Study Stop Rules |Planned interim analysis for futility | | | |
ABC111 |FCNTRY |Planned Country of Investigational Sites |USA | |USA |ISO 3166-1 alpha-3 |
ABC111 |THERAREA |Therapeutic Area |Oncology | | | |
ABC111 |SDTMVER |SDTM Version |SDTM v1.7 | | | |
ABC111 |SDTIGVER |SDTM IG Version |SDTMIG v3.4 | | | |
ABC111 |INTTYPE |Intervention Type |DRUG | |C1909 |CDISC |2024-06-28
ABC111 |INTMODEL |Intervention Model |PARALLEL | |C82639 |CDISC |2024-06-28
ABC111 |PCLAS |Pharmacologic Class | |UNK | |ISO 21090 |
ABC111 |TDIGRP |Diagnosis Group |Solid Tumor | |385002007 |SNOMED |2024-06-28
;
/*샘플 약물: 6CW7F3G59X(GABAPENTIN)*/
run;

data TS02;
retain STUDYID TSSEQ TSPARMCD TSPARM TSVAL TSVALNF TSVALCD TSVCDREF TSVCDVER;
set TS00 TS01;
TSSEQ = _N_;
run;

data TRIAL.TRIAL_TS_SAMPLE; set TS02; run;
